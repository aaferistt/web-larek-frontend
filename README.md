# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

---

# Архитектура проекта

Проект реализован по принципам **MVP (Model-View-Presenter)** с событийным подходом.  
Данные хранятся в моделях, отображение вынесено во View-классы, а координация работы выполняется через брокер событий.

## 1. Типы данных

### `IProduct`  
Описание товара:  
- `id: string` — идентификатор  
- `title: string` — название  
- `price: number | null` — цена  
- `description: string` — описание  
- `image: string` — ссылка на изображение  
- `category: string` — категория  
- `selected: boolean` — выбран ли товар  

### `IOrderForm`  
Данные заказа:  
- `payment: 'card' | 'cash'` — способ оплаты  
- `address: string` — адрес доставки  
- `phone: string` — телефон  
- `email: string` — почта  

### `IBasketItem`  
Элемент корзины:  
- `id: string` — товар  
- `title: string` — название  
- `price: number` — цена  
- `count: number` — количество  

### `IOrder`  
Заказ, объединяющий форму и список товаров:  
- `items: string[]`  
- `total: number`  

### API DTO  
- `ProductDTO` — структура товара с сервера  
- `OrderRequestDTO` — запрос на создание заказа  
- `OrderResponseDTO` — ответ сервера  

### Состояния форм  
- `OrderStateStep1` — шаг выбора оплаты и адреса  
- `OrderStateStep2` — шаг ввода телефона и почты  
- `OrderState` — объединяет оба шага  

### События (`AppEventMap`)  
В приложении используются события:  
- `catalog:loaded` — загрузка каталога  
- `product:open` — открытие карточки товара  
- `product:add` / `product:remove` — добавление или удаление из корзины  
- `cart:open` / `cart:changed` / `cart:cleared` — работа с корзиной  
- `checkout:open-step1` / `checkout:open-step2` — переходы между шагами заказа  
- `checkout:pay` — оформление заказа  
- `order:completed` — успешная оплата  
- `modal:open` / `modal:close` — работа модальных окон  

---

## 2. Основные классы

### Базовые  
- **Component** — общий класс для UI-элементов (методы для установки текста, изображений, переключения стилей).  
- **Model** — общий класс для моделей данных (работа через события).  
- **EventEmitter** — брокер событий (подписка, отписка, вызов событий).  

### Модели  
- **AppData** — управляет каталогом товаров, корзиной и данными заказа.  

### Представления (Views)  
- **Card** — карточка товара в каталоге.  
- **CardPreview** — модальное окно с деталями товара.  
- **Basket** — корзина товаров.  
- **BasketItem** — элемент корзины.  
- **Order** — форма заказа (оплата + адрес).  
- **Contacts** — форма контактов (почта + телефон).  
- **Modal** — модальное окно.  
- **Page** — главная страница с каталогом.  
- **Success** — окно успешного завершения заказа.  

---

## 3. Процессы (событийный подход)

1. Пользователь кликает по товару  
   → генерируется событие `product:open`  
   → открывается `CardPreview`.  

2. Нажатие «В корзину»  
   → `product:add`  
   → обновляется `Basket`, меняется счётчик.  

3. Открытие корзины  
   → событие `cart:open`  
   → показывается компонент `Basket`.  

4. Оформление заказа  
   → переход на шаг 1 (`checkout:open-step1`), ввод адреса и оплаты.  
   → переход на шаг 2 (`checkout:open-step2`), ввод почты и телефона.  
   → событие `checkout:pay`.  

5. При успешном заказе  
   → `order:completed`  
   → показывается `Success`, корзина очищается.  

---

## 4. Архитектурные принципы

- Разделение ответственности: каждая часть выполняет только свою задачу.  
- Событийный подход: взаимодействие между компонентами через брокер событий.  
- Расширяемость: легко добавить новые типы товаров или новые шаги заказа.  
- Используется паттерн **MVP**: модели (данные), views (отображение) и презентер (связка через события).  
